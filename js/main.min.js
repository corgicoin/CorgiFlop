function main(){function r(){T&&T.show({best:!0})}function i(){}function s(){if(x)return;postScoreText.setText("...");x=!0;$j.getJSON(faucet+"/flop/index?coins="+f,function(e){var t=e.body.data.key;t&&(window.location.href=faucet+"/flop/redeem/"+t);e.body.status=="error"&&postScoreText.setText(e.body.message+"!")})}function o(){var e={spritesheet:{doggie:["assets/doggie.png",24,24],clouds:["assets/clouds.png",128,64]},image:{tower:["assets/tower.png"],fence:["assets/fence.png"]},audio:{flap:["assets/flap.wav"],score:["assets/score.wav"],hurt:["assets/hurt.wav"]}};Object.keys(e).forEach(function(t){Object.keys(e[t]).forEach(function(r){n.load[t].apply(n.load,[r].concat(e[t][r]))})})}function _(){var e=t.clientWidth>window.innerWidth?window.innerWidth:t.clientWidth,r=t.clientHeight>window.innerHeight?window.innerHeight:t.clientHeight;M=!1;n.world.width=e;n.world.height=r;l=n.add.graphics(0,0);l.beginFill(13430527,1);l.drawRect(0,0,n.world.width,n.world.height);l.endFill();c=n.add.text(n.world.width/2,10,"",{font:'8px "Press Start 2P"',fill:"#fff",align:"center"});c.anchor.x=.5;h=n.add.group();p=n.add.group();d=n.add.group();v=n.add.sprite(0,0,"doggie");v.anchor.setTo(.5,.5);v.animations.add("fly",[0,1,2,3],10,!0);v.inputEnabled=!0;v.body.collideWorldBounds=!0;v.body.gravity.y=GRAVITY;m=n.add.tileSprite(0,n.world.height-32,n.world.width,32,"fence");m.tileScale.setTo(2,2);g=n.add.text(n.world.width/2,n.world.height/5,"",{font:'32px "Press Start 2P"',fill:"#fff",stroke:"#de9542",strokeThickness:12,align:"center"});g.anchor.setTo(.5,.5);y=n.add.text(n.world.width/2,n.world.height-n.world.height/4,"",{font:'16px "Press Start 2P"',fill:"#fff",stroke:"#466d85",strokeThickness:8,align:"center"});y.anchor.setTo(.5,.5);b=n.add.text(n.world.width/2,n.world.height/3,"",{font:'24px "Press Start 2P"',fill:"#fff",stroke:"#466d85",strokeThickness:8,align:"center"});b.anchor.setTo(.5,.5);postScoreText=n.add.text(n.world.width/2,n.world.height/2,"",{font:'20px "Press Start 2P"',fill:"#fff",stroke:"#309830",strokeThickness:8,align:"center"});postScoreText.setText("CLAIM\nCORGICOINS!");postScoreText.anchor.setTo(.5,.5);postScoreText.renderable=!1;S=new Phaser.Rectangle(0,postScoreText.y-postScoreText.height/2,n.world.width,postScoreText.height*2);w=n.add.text(3*n.world.width/4,n.world.height/2,"",{font:'20px "Press Start 2P"',fill:"#fff",stroke:"#466d85",strokeThickness:8,align:"center"});w.setText("KIK\nTHIS!");w.anchor.setTo(.5,.5);w.renderable=!1;E=new Phaser.Rectangle(w.x-w.width/2,w.y-w.height/2,w.width,w.height);N=n.add.audio("flap");C=n.add.audio("score");k=n.add.audio("hurt");O=n.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);n.input.onDown.add(B);mutePress=n.input.keyboard.addKey(Phaser.Keyboard.V);mutePress.onDown.add(D);A=new Phaser.Timer(n);A.onEvent.add(j);A.start();A.add(Math.random());P()}function D(){if(M){n.sound.mute=!1;M=!1}else{n.sound.mute=!0;M=!0}}function P(){v.events.onInputDown.removeAll();O.onDown.removeAll();O.onDown.add(B);u=!1;a=!1;f=0;c.renderable=!0;g.setText("CORGI\nFLOP");y.setText("TOUCH TO\nFLAP WINGS\n\nV for Mute");b.renderable=!1;postScoreText.renderable=!1;w.renderable=!1;v.body.allowGravity=!1;v.angle=0;v.reset(n.world.width/4,n.world.height/2);v.scale.setTo(2,2);v.animations.play("fly");p.removeAll();d.removeAll()}function H(){c.renderable=!1;v.body.allowGravity=!0;L=new Phaser.Timer(n);L.onEvent.add(q);L.start();L.add(2);g.setText(f);y.renderable=!1;u=!0}function B(){u||H();if(!a){v.body.velocity.y=-FLAP;N.play()}else S&&Phaser.Rectangle.contains(S,n.input.x,n.input.y)&&s()}function j(){A.stop();var e=Math.random()*n.height/2,t=h.create(n.width,e,"clouds",Math.floor(4*Math.random())),r=2+2*Math.random();t.alpha=2/r;t.scale.setTo(r,r);t.body.allowGravity=!1;t.body.velocity.x=-SPEED/r;t.anchor.y=0;A.start();A.add(4*Math.random())}function F(){return OPENING+60*((f>50?50:50-f)/50)}function I(e,t){var r=p.create(n.width,e+(t?-F():F())/2,"tower");r.body.allowGravity=!1;r.scale.setTo(2,t?-2:2);r.body.offset.y=t?-r.body.height*2:0;r.body.velocity.x=-SPEED;return r}function q(){L.stop();var e=(n.height-16-F()/2)/2+(Math.random()>.5?-1:1)*Math.random()*n.height/6,t=I(e),r=I(e,!0),i=d.create(r.x+r.width,0);i.width=2;i.height=n.world.height;i.body.allowGravity=!1;i.body.velocity.x=-SPEED;L.start();L.add(1/SPAWN_RATE)}function R(e,t){d.remove(t);f+=1;g.setText(f);C.play()}function U(){a=!0;y.setText("TOUCH CORGI\nTO TRY AGAIN");y.renderable=!0;var e=window.localStorage.getItem("hiscore");e=e?e:f;e=f>parseInt(e,10)?f:e;window.localStorage.setItem("hiscore",e);b.setText("HIGH SCORE\n"+e);b.renderable=!0;f>0&&(postScoreText.renderable=!0);p.forEachAlive(function(e){e.body.velocity.x=0});d.forEach(function(e){e.body.velocity.x=0});L.stop();O.onDown.addOnce(P);v.events.onInputDown.addOnce(P);k.play()}function z(){if(u){var e=FLAP+v.body.velocity.y;v.angle=90*e/FLAP-180;v.angle<-30&&(v.angle=-30);if(a||v.angle>90||v.angle<-90){v.angle=90;v.animations.stop();v.frame=3}else v.animations.play("fly");if(a){v.scale.x<4&&v.scale.setTo(v.scale.x*1.2,v.scale.y*1.2);b.scale.setTo(1+.1*Math.sin(n.time.now/100),1+.1*Math.cos(n.time.now/100));postScoreText.angle=Math.random()*5*Math.cos(n.time.now/100);w.angle=Math.random()*5*Math.sin(n.time.now/100)}else{n.physics.overlap(v,p,U);!a&&v.body.bottom>=n.world.bounds.bottom&&U();n.physics.overlap(v,d,R)}p.forEachAlive(function(e){e.x+e.width<n.world.bounds.left&&e.kill()});L.update()}else v.y=n.world.height/2+8*Math.cos(n.time.now/200);(!u||a)&&y.scale.setTo(1+.1*Math.sin(n.time.now/100),1+.1*Math.cos(n.time.now/100));g.scale.setTo(1+.1*Math.cos(n.time.now/100),1+.1*Math.sin(n.time.now/100));A.update();h.forEachAlive(function(e){e.x+e.width<n.world.bounds.left&&e.kill()});a||(m.tilePosition.x-=n.time.physicsElapsed*SPEED/2)}function W(){if(DEBUG){n.debug.renderSpriteBody(v);p.forEachAlive(function(e){n.debug.renderSpriteBody(e)});d.forEach(function(e){n.debug.renderSpriteBody(e)})}}var e={preload:o,create:_,update:z,render:W},t=document.querySelector("#screen"),n=new Phaser.Game(0,0,Phaser.CANVAS,t,e,!1,!1),u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M}var $j=jQuery,DEBUG=!1,SPEED=180,GRAVITY=18,FLAP=420,SPAWN_RATE=1/1.2,OPENING=144,faucet="http://givemecorgicoins.com";$j(document).ready(function(){WebFontConfig={google:{families:["Press+Start+2P::latin"]},active:main};(function(){var e=document.createElement("script");e.src=("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js";e.type="text/javascript";e.async="true";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()});